---
/**
 * LogoCloud - Client/partner logo showcase section
 *
 * @description
 * Displays a collection of client or partner logos to build trust and credibility.
 * Supports multiple display variants: static row, animated marquee, or grid layout.
 *
 * @example Default variant (static row)
 * ```astro
 * <LogoCloud
 *   title="Trusted by innovative teams"
 *   logos={[
 *     { name: "Logo Impsum 1", src: "/images/logos/logoipsum-1.svg" },
 *     { name: "Logo Impsum 2", src: "/images/logos/logoipsum-2.svg" },
 *   ]}
 * />
 * ```
 *
 * @example Marquee variant (animated scroll)
 * ```astro
 * <LogoCloud
 *   logos={logos}
 *   variant="marquee"
 *   speed="slow"
 * />
 * ```
 *
 * @example Grid variant
 * ```astro
 * <LogoCloud
 *   title="Our partners"
 *   logos={logos}
 *   variant="grid"
 *   columns={4}
 * />
 * ```
 */

interface Logo {
  /** Company/brand name (used for alt text) */
  name: string;
  /** Path to logo image */
  src: string;
  /** Optional link URL */
  href?: string;
}

interface Props {
  /** Section title (optional) */
  title?: string;
  /** Array of logo objects */
  logos: Logo[];
  /** Display variant */
  variant?: 'default' | 'marquee' | 'grid';
  /** Number of columns for grid variant */
  columns?: 2 | 3 | 4 | 5 | 6;
  /** Animation speed for marquee variant */
  speed?: 'slow' | 'normal' | 'fast';
  /** Pause marquee on hover */
  pauseOnHover?: boolean;
  /** Logo size */
  logoSize?: 'sm' | 'md' | 'lg';
  /** Grayscale logos (colored on hover) */
  grayscale?: boolean;
}

const {
  title,
  logos,
  variant = 'default',
  columns = 4,
  speed = 'normal',
  pauseOnHover = true,
  logoSize = 'md',
  grayscale = true,
} = Astro.props;

// Logo size classes
const sizeClasses = {
  sm: 'h-6 max-w-[80px]',
  md: 'h-8 max-w-[120px]',
  lg: 'h-10 max-w-[150px]',
};

// Grid column classes
const columnClasses = {
  2: 'grid-cols-2',
  3: 'grid-cols-2 sm:grid-cols-3',
  4: 'grid-cols-2 sm:grid-cols-3 lg:grid-cols-4',
  5: 'grid-cols-2 sm:grid-cols-3 lg:grid-cols-5',
  6: 'grid-cols-2 sm:grid-cols-3 lg:grid-cols-6',
};

// Marquee speed (duration in seconds)
const speedDuration = {
  slow: '40s',
  normal: '25s',
  fast: '15s',
};

// Grayscale classes
const grayscaleClass = grayscale
  ? 'grayscale opacity-60 hover:grayscale-0 hover:opacity-100 transition-all duration-300'
  : '';
---

<section class="py-12 bg-background">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {title && (
      <p class="text-center text-sm font-medium text-text-muted mb-8">
        {title}
      </p>
    )}

    {/* Default variant - static row */}
    {variant === 'default' && (
      <div class="flex flex-wrap items-center justify-center gap-x-12 gap-y-8">
        {logos.map((logo) => (
          logo.href ? (
            <a
              href={logo.href}
              target="_blank"
              rel="noopener noreferrer"
              class={`block ${grayscaleClass}`}
            >
              <img
                src={logo.src}
                alt={logo.name}
                class={`${sizeClasses[logoSize]} w-auto object-contain`}
                loading="lazy"
              />
            </a>
          ) : (
            <div class={grayscaleClass}>
              <img
                src={logo.src}
                alt={logo.name}
                class={`${sizeClasses[logoSize]} w-auto object-contain`}
                loading="lazy"
              />
            </div>
          )
        ))}
      </div>
    )}

    {/* Marquee variant - animated scroll */}
    {variant === 'marquee' && (
      <div
        class="logo-marquee overflow-hidden"
        style={`--marquee-duration: ${speedDuration[speed]}`}
        data-pause-on-hover={pauseOnHover ? 'true' : 'false'}
      >
        <div class="logo-marquee-track flex items-center gap-12">
          {/* First set of logos */}
          {logos.map((logo) => (
            logo.href ? (
              <a
                href={logo.href}
                target="_blank"
                rel="noopener noreferrer"
                class={`flex-shrink-0 ${grayscaleClass}`}
              >
                <img
                  src={logo.src}
                  alt={logo.name}
                  class={`${sizeClasses[logoSize]} w-auto object-contain`}
                  loading="lazy"
                />
              </a>
            ) : (
              <div class={`flex-shrink-0 ${grayscaleClass}`}>
                <img
                  src={logo.src}
                  alt={logo.name}
                  class={`${sizeClasses[logoSize]} w-auto object-contain`}
                  loading="lazy"
                />
              </div>
            )
          ))}
          {/* Duplicate for seamless loop */}
          {logos.map((logo) => (
            logo.href ? (
              <a
                href={logo.href}
                target="_blank"
                rel="noopener noreferrer"
                class={`flex-shrink-0 ${grayscaleClass}`}
                aria-hidden="true"
              >
                <img
                  src={logo.src}
                  alt=""
                  class={`${sizeClasses[logoSize]} w-auto object-contain`}
                  loading="lazy"
                />
              </a>
            ) : (
              <div class={`flex-shrink-0 ${grayscaleClass}`} aria-hidden="true">
                <img
                  src={logo.src}
                  alt=""
                  class={`${sizeClasses[logoSize]} w-auto object-contain`}
                  loading="lazy"
                />
              </div>
            )
          ))}
        </div>
      </div>
    )}

    {/* Grid variant */}
    {variant === 'grid' && (
      <div class={`grid ${columnClasses[columns]} gap-8 items-center justify-items-center`}>
        {logos.map((logo) => (
          logo.href ? (
            <a
              href={logo.href}
              target="_blank"
              rel="noopener noreferrer"
              class={`block ${grayscaleClass}`}
            >
              <img
                src={logo.src}
                alt={logo.name}
                class={`${sizeClasses[logoSize]} w-auto object-contain`}
                loading="lazy"
              />
            </a>
          ) : (
            <div class={grayscaleClass}>
              <img
                src={logo.src}
                alt={logo.name}
                class={`${sizeClasses[logoSize]} w-auto object-contain`}
                loading="lazy"
              />
            </div>
          )
        ))}
      </div>
    )}
  </div>
</section>

<style>
  .logo-marquee-track {
    animation: marquee var(--marquee-duration, 25s) linear infinite;
  }

  .logo-marquee[data-pause-on-hover='true']:hover .logo-marquee-track {
    animation-play-state: paused;
  }

  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .logo-marquee-track {
      animation: none;
    }
  }
</style>
